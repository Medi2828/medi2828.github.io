<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Portfolio</title>
  <link rel="stylesheet" href="css/portfolio.css">
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="header">
        <img id="portfolioAvatar" class="avatar" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='96' height='96'><rect width='96' height='96' fill='black'/></svg>" alt="Profile" title="Click to change profile picture">
        <div>
         <h1 id="portfolioName" contenteditable="true" style="outline:1px dashed #ccc;">Your Name</h1>
          <p id="portfolioLead" class="lead" contenteditable="true">Student</p>
          <a class="top-link" href="home.html">‚Üê Back to Study Space</a>
        </div>
      </div>

      <h2>About</h2>
      <textarea id="aboutText" style="width:100%;min-height:80px;padding:8px;border-radius:6px;border:1px solid #ddd;">I am a student. This portfolio shows a few sample projects and contact links.</textarea>

      <h2>Projects</h2>
      <ul id="projectsList" class="projects">
        <li>
          <div contenteditable="true"><b>Project 1</b></div>
          <div contenteditable="true">Add details about your first project here.</div>
        </li>
        <li>
          <div contenteditable = "true"><b>Project 2</b></div>
          <div contenteditable="true">Add details about your second project here.</div>
        </li>
        <li>    
          <div contenteditable ="true"><b>Project 3</b></div>
          <div contenteditable="true">Add details about your third project here.</div>
        </li>
      </ul>

      <h2>Contact</h2>
      <p class="contact">Email: <span id="portfolioEmail" contenteditable="true" style="outline:1px dashed #ccc;">your.email@example.com</span></p>

      <div style="margin-top:18px;display:flex;gap:10px;align-items:center;">
        <input type="file" id="portfolioAvatarUpload" accept="image/*" style="display:none">
        <button id="savePortfolio" class="save-btn">Save Portfolio</button>
      </div>
    </div>
  </div>

  <script>

    const user = localStorage.getItem('registered_user') || 'default';
    const saved = JSON.parse(localStorage.getItem(user + '_portfolio') || '{}');

    function loadPortfolio() {
      if (saved.name) document.getElementById('portfolioName').textContent = saved.name;
      if (saved.lead) document.getElementById('portfolioLead').textContent = saved.lead;
      if (saved.about) document.getElementById('aboutText').value = saved.about;
      if (saved.email) document.getElementById('portfolioEmail').textContent = saved.email;
      if (saved.avatar) document.getElementById('portfolioAvatar').src = saved.avatar;
    
      if (Array.isArray(saved.projects)) {
        const projectsList = document.getElementById('projectsList');
        projectsList.innerHTML = '';
        saved.projects.forEach(p => {
          const li = document.createElement('li');
          const strong = document.createElement('strong'); strong.textContent = p.title;
          const desc = document.createElement('div'); desc.contentEditable = true; desc.innerHTML = p.desc;
          li.appendChild(strong); li.appendChild(desc); projectsList.appendChild(li);
        });
      }
    }

    function savePortfolio() {
      const name = document.getElementById('portfolioName').textContent.trim();
      const lead = document.getElementById('portfolioLead').textContent.trim();
      const about = document.getElementById('aboutText').value.trim();
      const email = document.getElementById('portfolioEmail').textContent.trim();
      const avatar = document.getElementById('portfolioAvatar').src;
      const projects = [];
      document.querySelectorAll('#projectsList li').forEach(li => {
        const t = li.querySelector('strong')?.textContent || 'Project';
        const d = li.querySelector('div')?.innerHTML || '';
        projects.push({ title: t, desc: d });
      });
      const data = { name, lead, about, email, avatar, projects };
      localStorage.setItem(user + '_portfolio', JSON.stringify(data));
      alert('Portfolio saved for ' + user);
    }

    document.getElementById('savePortfolio').addEventListener('click', savePortfolio);


    document.getElementById('portfolioAvatar').addEventListener('click', function() {
      document.getElementById('portfolioAvatarUpload').click();
    });

    document.getElementById('portfolioAvatarUpload').addEventListener('change', function(e){
      const f = e.target.files[0];
      if (!f) return;
      const r = new FileReader();
      r.onload = function(ev){ document.getElementById('portfolioAvatar').src = ev.target.result; };
      r.readAsDataURL(f);
    });

    loadPortfolio();
  </script>
</body>
</html>